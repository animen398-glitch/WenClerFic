# Информация о хранении данных пользователей

## Где хранятся данные пользователей

### База данных SQLite

Все данные пользователей хранятся в **SQLite базе данных**:

- **Локальная разработка**: `data/wenclerfic.db` (в папке проекта)
- **На сервере Vercel**: `/tmp/wenclerfic.db` (временная папка)

### Таблица users

Данные пользователей хранятся в таблице `users` со следующими полями:

- `id` - уникальный идентификатор пользователя
- `username` - имя пользователя (уникальное, без учета регистра)
- `email` - email адрес (уникальный)
- `password` - хешированный пароль (bcrypt)
- `avatar` - ссылка на аватар пользователя
- `provider` - провайдер OAuth (google, facebook) или null
- `isProfileComplete` - флаг завершенности профиля (0 или 1)
- `createdAt` - дата создания аккаунта

### Сессии пользователей

Сессии хранятся в таблице `sessions`:

- `userId` - ID пользователя
- `token` - токен сессии
- `expiresAt` - время истечения сессии
- Сессии также сохраняются в cookies браузера

### Локальное хранилище браузера

Для быстрого доступа данные также кешируются в `localStorage` браузера:

- `user` - данные пользователя (JSON)
- `token` - токен сессии

## Безопасность

- Пароли хешируются с помощью bcrypt перед сохранением
- Сессии хранятся в httpOnly cookies (недоступны из JavaScript)
- Username проверяется на уникальность без учета регистра (Hiccup и hiccup - одно и то же)

## Как работает вход после регистрации

1. При регистрации автоматически создается сессия
2. Сессия сохраняется в cookies и localStorage
3. При следующем заходе на сайт:
   - Проверяется сессия из cookies
   - Если сессия валидна - пользователь автоматически входит
   - Если сессии нет - можно войти через форму входа

## Форма входа

Для входа используйте:
- **Email** - тот же email, который использовали при регистрации
- **Пароль** - пароль, который установили при регистрации
- **"Запомнить меня"** - сохраняет сессию на 30 дней вместо 7

## Проверка уникальности логина

- Логины проверяются **без учета регистра** (case-insensitive)
- "Hiccup", "HICCUP", "hiccup" - все считаются одинаковыми
- Если логин уже занят, вы получите сообщение: "Имя пользователя уже занято. Попробуйте другое имя."

